<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sticky Notes 메모장</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            background-color: #f0f0f0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            width: 300px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .modal-title {
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: bold;
        }

        .modal-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .modal-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .modal-btn.confirm {
            background-color: #4a90e2;
            color: white;
        }

        .modal-btn.cancel {
            background-color: #f0f0f0;
        }


        #header {
            display: flex;
            padding: 10px;
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            align-items: center;
            gap: 10px;
            z-index: 200;
        }

        #canvas-select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-width: 150px;
        }

        #canvas-title {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex-grow: 1;
            max-width: 200px;
        }

        .header-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            background-color: #4a90e2;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .header-btn:hover {
            background-color: #357abd;
        }

        .header-btn.danger {
            background-color: #e74c3c;
        }

        .header-btn.danger:hover {
            background-color: #c0392b;
        }

        #canvas-container {
            position: absolute;
            width: 100%;
            height: calc(100vh - 80px); /* 투명도 컨트롤러 공간 확보 */
            overflow: hidden;
            background-color: #f5f5f5;
            background-image: 
                linear-gradient(rgba(0, 0, 0, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 0, 0, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: center;
            transition: transform 0.3s ease;
            touch-action: none;
            user-select: none; /* 드래그 시 텍스트 선택 방지 */
        }
        

        #canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-origin: 0 0;
            cursor: default;
            pointer-events: none; /* 캔버스 자체가 이벤트를 막지 않도록 */
        }

        .note {
            position: absolute;
            width: 200px;
            min-height: 200px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 2px;
            display: flex;
            flex-direction: column;
            transition: box-shadow 0.3s ease;
            cursor: grab;
            resize: none;
            overflow: hidden;
            pointer-events: auto; /* 메모지만 이벤트 처리 */
        }

        .note:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .note-type {
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .note-actions {
            display: flex;
            gap: 5px;
        }

        .note-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 12px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .note-actions button:hover {
            opacity: 1;
        }

        .note-content {
            flex-grow: 1;
            outline: none;
            overflow-wrap: break-word;
            resize: none;
            border: none;
            background: transparent;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 10px;
            overflow: auto;
        }

        .note-footer {
            font-size: 10px;
            color: rgba(0, 0, 0, 0.5);
            text-align: right;
            position: relative;
            padding-right: 10px;
        }

        .resize-handle {
            position: absolute;
            right: -15px;
            bottom: -15px;
            width: 10px;
            height: 10px;
            background-color: rgba(240, 18, 18, 0.932);
            cursor: nwse-resize;
            border-radius: 2px;
        }

        #add-note-btn {
            position: fixed;
            bottom: 70px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #ffeb3b;
            border: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            font-size: 24px;
            cursor: pointer;
            z-index: 100;
        }

        #add-note-btn:hover {
            background-color: #fdd835;
        }

        #zoom-controls {
            position: fixed;
            bottom: 130px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 100;
        }

        .zoom-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: white;
            border: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .zoom-btn:hover {
            background-color: #f5f5f5;
        }

        #zoom-level {
            position: fixed;
            bottom: 180px;
            right: 30px;
            background-color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }


        #context-menu {
            position: absolute;
            display: none;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            min-width: 150px;
        }

        .context-menu-item {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
        }

        .context-menu-item:hover {
            background-color: #f5f5f5;
        }

        .context-menu-divider {
            height: 1px;
            background-color: #eee;
            margin: 4px 0;
        }

         /* 검색 영역 스타일 추가 */
         #search-container {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
        }

        #search-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 150px;
        }

        .search-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            background-color: #4a90e2;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .search-btn:hover {
            background-color: #357abd;
        }

        .search-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        /* 검색된 메모 하이라이트 스타일 */
        .note.highlighted {
            box-shadow: 0 0 0 3px #ff5722;
            animation: pulse 0.5s;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* 투명도 컨트롤러 스타일 */
        #opacity-controls {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30px;
            background-color: #ffffff;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        #opacity-slider {
            flex-grow: 1;
            margin: 0 10px;
        }

        #opacity-value {
            width: 40px;
            text-align: center;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div id="header">
        <select id="canvas-select"></select>
        <input type="text" id="canvas-title" placeholder="캔버스 제목">
        <button id="save-canvas-btn" class="header-btn">캔버스 저장</button>
        <button id="new-canvas-btn" class="header-btn">새 캔버스</button>
        <button id="clear-canvas-btn" class="header-btn">캔버스 비우기</button>
        <button id="delete-canvas-btn" class="header-btn danger">캔버스 삭제</button>
        <button id="export-btn" class="header-btn">파일로 내보내기</button>
        <button id="import-btn" class="header-btn">파일 불러오기</button>
        
        <!-- 검색 영역 추가 -->
        <div id="search-container">
            <input type="text" id="search-input" placeholder="검색어 입력">
            <button id="search-btn" class="search-btn">검색</button>
            <button id="prev-btn" class="search-btn" disabled>이전</button>
            <button id="next-btn" class="search-btn" disabled>다음</button>
        </div>
    </div>

    <!-- 모달 창 추가 -->
    <div id="new-canvas-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title">새 캔버스 제목 입력</div>
            <input type="text" id="new-canvas-title" class="modal-input" placeholder="캔버스 제목을 입력하세요">
            <div class="modal-actions">
                <button id="cancel-new-canvas" class="modal-btn cancel">취소</button>
                <button id="confirm-new-canvas" class="modal-btn confirm">생성</button>
            </div>
        </div>
    </div>
    
    <div id="canvas-container">
        <div id="canvas"></div>
    </div>
    
    <!-- 투명도 컨트롤러 추가 -->
    <div id="opacity-controls">
        <span>투명도:</span>
        <input type="range" id="opacity-slider" min="30" max="100" value="100">
        <span id="opacity-value">100%</span>
    </div>
    
    <div id="zoom-controls">
        <button class="zoom-btn" id="zoom-in">+</button>
        <button class="zoom-btn" id="zoom-out">-</button>
        <button class="zoom-btn" id="zoom-reset">↻</button>
    </div>
    <div id="zoom-level">100%</div>
    
    <button id="add-note-btn">+</button>

    <!-- 컨텍스트 메뉴 추가 -->
    <div id="context-menu">
        <div class="context-menu-item" id="context-add-note">메모 추가</div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="context-align-notes">시작점 정렬</div>
    </div>

    <script>
        const noteTypes={default:"#ffeb3b",important:"#ff8a65",idea:"#81d4fa",reminder:"#ce93d8",personal:"#a5d6a7"},defaultNoteType="default",defaultNotePosition={left:"50%",top:"50%"};document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("canvas-container"),t=document.getElementById("canvas"),n=document.getElementById("add-note-btn"),l=document.getElementById("zoom-in"),i=document.getElementById("zoom-out"),o=document.getElementById("zoom-reset"),s=document.getElementById("zoom-level"),a=document.getElementById("canvas-select"),c=document.getElementById("canvas-title"),d=document.getElementById("save-canvas-btn"),r=document.getElementById("export-btn"),u=document.getElementById("import-btn"),y=document.getElementById("new-canvas-modal"),g=document.getElementById("new-canvas-title"),f=document.getElementById("confirm-new-canvas"),p=document.getElementById("cancel-new-canvas"),v=document.getElementById("context-menu"),m=document.getElementById("context-add-note"),h=document.getElementById("context-align-notes"),E={x:0,y:0},$=document.getElementById("search-input"),I=document.getElementById("search-btn"),k=document.getElementById("prev-btn"),x=document.getElementById("next-btn"),L=document.getElementById("opacity-slider"),B=document.getElementById("opacity-value"),_=!1,b=0,w=0,S=[],C=-1,A="",T=1,N=0,q=0,X=null,Y={};function z(){if(N=0,q=0,T=1,_=!1,F(),G(),0===Object.keys(Y).length)R();else{let e=Object.keys(Y)[0];K(e)}M(),W(),eo(),O(),D(),P(),document.addEventListener("click",e=>{e.target.closest("#context-menu")||e.target.closest("#search-container")||e.target.closest(".note.highlighted")||(es(),eu())})}function D(){let e=document.getElementById("canvas-container");e.addEventListener("mousedown",t=>{t.target.classList.contains("note")||t.target!==e||(_=!0,b=t.clientX-N,w=t.clientY-q,e.style.cursor="grabbing",t.preventDefault(),console.log("드래그 시작",b,w))}),document.addEventListener("mousemove",e=>{_&&(N=e.clientX-b,q=e.clientY-w,P())}),document.addEventListener("mouseup",()=>{_=!1,e.style.cursor="default"}),e.addEventListener("touchstart",t=>{if(t.target!==e)return;_=!0;let n=t.touches[0];b=n.clientX-N,w=n.clientY-q,t.preventDefault()}),document.addEventListener("touchmove",e=>{if(!_)return;let t=e.touches[0];N=t.clientX-b,q=t.clientY-w,P(),e.preventDefault()}),document.addEventListener("touchend",()=>{_=!1})}function O(){L.addEventListener("input",()=>{let e=L.value;B.textContent=`${e}%`,document.querySelectorAll(".note").forEach(t=>{t.style.opacity=e/100}),X&&(Y[X].opacity=e/100,Q())})}function R(){g.value="",y.style.display="flex",g.focus()}function M(){n.addEventListener("click",()=>{et()}),document.getElementById("new-canvas-btn").addEventListener("click",()=>{J()}),document.getElementById("delete-canvas-btn").addEventListener("click",()=>{X&&confirm("정말로 이 캔버스를 삭제하시겠습니까? 삭제 후 복구할 수 없습니다.")&&eg(X)}),document.getElementById("clear-canvas-btn").addEventListener("click",()=>{X&&confirm("현재 캔버스의 모든 메모를 삭제하시겠습니까?")&&ef()}),document.getElementById("new-canvas-btn").addEventListener("click",()=>{R()}),f.addEventListener("click",()=>{let e=g.value.trim();e?(J(e),y.style.display="none"):alert("캔버스 제목을 입력해주세요.")}),p.addEventListener("click",()=>{y.style.display="none",0===Object.keys(Y).length&&J("새 캔버스")}),y.addEventListener("click",e=>{e.target===y&&(y.style.display="none",0===Object.keys(Y).length&&J("새 캔버스"))}),c.addEventListener("change",()=>{if(!X)return;let e=c.value.trim();e&&e!==Y[X].title&&ey(e)}),l.addEventListener("click",()=>{j(1.1)}),i.addEventListener("click",()=>{j(.9)}),o.addEventListener("click",()=>{H()}),a.addEventListener("change",e=>{e.target.value&&K(e.target.value)}),d.addEventListener("click",()=>{Q()}),r.addEventListener("click",()=>{ev()}),u.addEventListener("click",()=>{em()})}function j(e){T*=e,P(),V()}function H(){T=1,N=0,q=0,P(),V()}function P(){let e=document.getElementById("canvas");e.style.transform=`translate(${N}px, ${q}px) scale(${T})`,console.log("현재 위치:",N,q)}function V(){s.textContent=`${Math.round(100*T)}%`}function F(){let e=localStorage.getItem("stickyNotesCanvases");e&&(Y=JSON.parse(e))}function G(){a.innerHTML="",Object.keys(Y).forEach(e=>{let t=document.createElement("option");t.value=e,t.textContent=Y[e].title||`캔버스 ${e}`,a.appendChild(t)}),X&&(a.value=X)}function J(e){if(!e||!e.trim())return alert("캔버스 제목을 입력해주세요."),null;let t=Date.now().toString();return X=t,Y[t]={id:t,title:e.trim(),notes:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),opacity:1},G(),c.value=e.trim(),L.value=100,B.textContent="100%",U(),localStorage.setItem("stickyNotesCanvases",JSON.stringify(Y)),t}function K(e){if(!Y[e])return;X=e;let t=Y[e];c.value=t.title||"";let n=void 0!==t.opacity?t.opacity:1;L.value=100*n,B.textContent=`${100*n}%`,U(),t.notes&&t.notes.length>0&&t.notes.forEach(e=>{et(e.content,e.type,e.position,e.id,e.size,e.opacity)}),G()}function Q(){if(!X)return;let e=c.value.trim();Y[X].title=e,Y[X].updatedAt=new Date().toISOString(),Y[X].opacity=parseFloat(L.value)/100;let t=[],n=document.querySelectorAll(".note");n.forEach(e=>{t.push({id:e.id,content:e.querySelector(".note-content").value,type:e.querySelector(".note-type").textContent,position:{left:e.style.left,top:e.style.top},size:{width:e.style.width,height:e.style.height},opacity:parseFloat(e.style.opacity||"1"),createdAt:e.querySelector(".note-footer").textContent})}),Y[X].notes=t,localStorage.setItem("stickyNotesCanvases",JSON.stringify(Y)),G()}function U(){t.innerHTML=""}function W(){e.addEventListener("contextmenu",e=>{e.preventDefault(),E={x:e.clientX,y:e.clientY},v.style.display="block",v.style.left=`${e.clientX}px`,v.style.top=`${e.clientY}px`}),document.addEventListener("click",()=>{v.style.display="none"}),m.addEventListener("click",()=>{Z(E),v.style.display="none"}),h.addEventListener("click",()=>{ee(E),v.style.display="none"})}function Z(t){if(!X)return;let n=e.getBoundingClientRect(),l=t.x-n.left-N,i=t.y-n.top-q,o=l/T,s=i/T,a=et("",defaultNoteType,{left:`${o}px`,top:`${s}px`});return Q(),a}function ee(t){if(!X||!Y[X]||!Y[X].notes)return;let n=e.getBoundingClientRect(),l=(t.x-n.left-N)/T,i=(t.y-n.top-q)/T,o=[...Y[X].notes];o.sort((e,t)=>new Date(e.createdAt)-new Date(t.createdAt));let s=Array.from(document.querySelectorAll(".note"));o.forEach((e,t)=>{let n=s.find(t=>t.id===e.id);if(!n)return;let o=l+t%5*220,a=i+220*Math.floor(t/5);n.style.left=`${o}px`,n.style.top=`${a}px`,e.position={left:`${o}px`,top:`${a}px`}}),Y[X].notes=o,Q()}function et(e="",n=defaultNoteType,l=null,i=null,o=null,s=null){i=i||Date.now().toString();let a=document.createElement("div");a.className="note",a.id=i,a.style.backgroundColor=noteTypes[n]||noteTypes[defaultNoteType];let c=null!==s?s:parseFloat(L.value)/100;if(a.style.opacity=c,l)a.style.left=l.left,a.style.top=l.top;else{let d=t.getBoundingClientRect();a.style.left=`${d.width/2-100}px`,a.style.top=`${d.height/2-100}px`}o&&o.width&&o.height?(a.style.width=o.width,a.style.height=o.height):(a.style.width="200px",a.style.height="200px"),a.innerHTML=`
                    <div class="note-header">
                        <span class="note-type">${n}</span>
                        <div class="note-actions">
                            <button class="change-type-btn">✏️</button>
                            <button class="delete-btn">🗑️</button>
                        </div>
                    </div>
                    <textarea class="note-content" placeholder="메모를 입력하세요...">${e}</textarea>
                    <div class="note-footer">${new Date().toLocaleDateString()}
                        <div class="resize-handle"></div>
                    </div>
                `,t.appendChild(a),en(a),el(a);let r=a.querySelector(".delete-btn"),u=a.querySelector(".change-type-btn"),y=a.querySelector(".note-content");return r.addEventListener("click",()=>{ep(i)}),u.addEventListener("click",()=>{ei(i)}),y.addEventListener("input",()=>{X&&Q()}),i}function en(e){let t=0,n=0,l=0,i=0,o=!1;function s(s){if(!o)return;(s=s||window.event).preventDefault(),t=l-s.clientX,n=i-s.clientY,l=s.clientX,i=s.clientY;let a=parseFloat(e.style.left||"0"),c=parseFloat(e.style.top||"0");e.style.left=a-t/T+"px",e.style.top=c-n/T+"px",X&&Q()}function a(){document.onmouseup=null,document.onmousemove=null,e.style.cursor="grab",o=!1}e.onmousedown=function t(n){!n.target.classList.contains("resize-handle")&&"TEXTAREA"!==n.target.tagName&&(n.preventDefault(),l=n.clientX,i=n.clientY,document.onmouseup=a,document.onmousemove=s,e.style.cursor="grabbing",o=!0)}}function el(e){let t=e.querySelector(".resize-handle"),n,l,i,o;function s(t){let s=i+(t.clientX-n)/T,a=o+(t.clientY-l)/T;s=Math.max(s,100),a=Math.max(a,100),e.style.width=`${s}px`,e.style.height=`${a}px`}function a(){document.onmousemove=null,document.onmouseup=null,X&&Q()}t.addEventListener("mousedown",function t(c){c.preventDefault(),c.stopPropagation(),n=c.clientX,l=c.clientY,i=parseInt(document.defaultView.getComputedStyle(e).width,10),o=parseInt(document.defaultView.getComputedStyle(e).height,10),document.onmousemove=s,document.onmouseup=a})}function ei(e){let t=document.getElementById(e);if(!t)return;let n=t.querySelector(".note-type").textContent,l=Object.keys(noteTypes),i=l.indexOf(n),o=(i+1)%l.length,s=l[o];t.querySelector(".note-type").textContent=s,t.style.backgroundColor=noteTypes[s],X&&Q()}function eo(){I.addEventListener("click",()=>{console.log("검색버튼 누름");let e=$.value.trim();e&&ea(e)}),k.addEventListener("click",()=>{console.log("이전버튼 누름"),ec(-1)}),x.addEventListener("click",()=>{console.log("다음버튼 누름"),ec(1)}),$.addEventListener("keypress",e=>{if("Enter"===e.key){let t=$.value.trim();t&&ea(t)}})}function es(){document.querySelectorAll(".note.highlighted").forEach(e=>{e.classList.remove("highlighted")})}function ea(e){if(!X||!Y[X])return;es(),A=e,S=[];let t=Y[X].notes;t.forEach(t=>{let n=document.getElementById(t.id);n&&t.content.includes(e)&&S.push(t.id)}),S.length>0?(ed(S[C=0]),er(S[C]),eu()):(alert("검색어와 일치하는 메모를 찾을 수 없습니다."),C=-1,eu()),console.log("검색 결과 배열:",S)}function ec(e){0!==S.length&&(es(),console.log("currentSearchIndex : "+C),console.log("추가할 숫자 : "+e),C+=e,console.log("이동할 순번 : "+C),console.log("searchResults.length : "+S.length),C>=S.length?C=0:C<0&&(C=S.length-1),ed(S[C]),er(S[C]),eu())}function ed(e){let t=document.getElementById(e);t&&t.classList.add("highlighted")}function er(t){let n=document.getElementById(t);if(!n)return;let l=n.getBoundingClientRect(),i=e.getBoundingClientRect(),o=l.left+l.width/2,s=l.top+l.height/2,a=i.width/2,c=i.height/2;N+=a-o,q+=c-s,P()}function eu(){k.disabled=0===S.length,x.disabled=0===S.length,$.value.trim()!==A?(I.disabled=!1,k.disabled=!0,x.disabled=!0):I.disabled=!1}function ey(e){if(!X)return;let t=Y[X],n=Date.now().toString();Y[n]={id:n,title:e,notes:JSON.parse(JSON.stringify(t.notes)),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),opacity:parseFloat(L.value)/100},X=n,localStorage.setItem("stickyNotesCanvases",JSON.stringify(Y)),G(),c.value=e,alert("새 캔버스로 저장되었습니다.")}function eg(e){if(Y[e]){if(delete Y[e],localStorage.setItem("stickyNotesCanvases",JSON.stringify(Y)),Object.keys(Y).length>0){let t=Object.keys(Y)[0];K(t)}else J();G()}}function ef(){X&&(U(),Y[X].notes=[],Y[X].updatedAt=new Date().toISOString(),localStorage.setItem("stickyNotesCanvases",JSON.stringify(Y)))}function ep(e){let t=document.getElementById(e);t&&(t.remove(),X&&Q())}function ev(){if(0===Object.keys(Y).length){alert("내보낼 캔버스가 없습니다.");return}let e=JSON.stringify(Y,null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(e),n=`sticky-notes-${new Date().toISOString().slice(0,10)}.json`,l=document.createElement("a");l.setAttribute("href",t),l.setAttribute("download",n),l.click()}function em(){let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{let t=e.target.files[0];if(!t)return;let n=new FileReader;n.onload=e=>{try{let t=JSON.parse(e.target.result);Y={...Y,...t},localStorage.setItem("stickyNotesCanvases",JSON.stringify(Y)),G();let n=Object.keys(t)[0];K(n),alert("캔버스 데이터가 성공적으로 불러와졌습니다.")}catch(l){alert("파일을 읽는 중 오류가 발생했습니다: "+l.message)}},n.readAsText(t)},e.click()}z()});
    </script>
</body>
</html>
